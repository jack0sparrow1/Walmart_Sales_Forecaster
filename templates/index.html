<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Forecasting</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; }
        form { display: grid; grid-template-columns: 1fr 1fr; gap: 1em; max-width: 600px; }
        label { grid-column: 1 / 2; text-align: right; }
        input { grid-column: 2 / 3; }
        button { grid-column: 1 / 3; }
        #predictionResult { margin-top: 1em; font-size: 1.2em; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Walmart Sales Forecast</h1>
    <form id="forecastForm">
        <label for="Store">Store:</label>
        <input type="number" id="Store" name="Store" value="1" required>

        <label for="Holiday_Flag">Holiday Flag (0 for No, 1 for Yes):</label>
        <input type="number" id="Holiday_Flag" name="Holiday_Flag" value="0" min="0" max="1" required>

        <label for="Temperature">Temperature (Â°F):</label>
        <input type="number" id="Temperature" name="Temperature" value="45.31" step="0.01" required>

        <label for="Fuel_Price">Fuel Price:</label>
        <input type="number" id="Fuel_Price" name="Fuel_Price" value="2.572" step="0.001" required>

        <label for="CPI">CPI:</label>
        <input type="number" id="CPI" name="CPI" value="211.096" step="0.001" required>

        <label for="Unemployment">Unemployment:</label>
        <input type="number" id="Unemployment" name="Unemployment" value="8.106" step="0.001" required>

        <label for="Year">Year:</label>
        <input type="number" id="Year" name="Year" value="2012" required>

        <label for="Month">Month:</label>
        <input type="number" id="Month" name="Month" value="1" min="1" max="12" required>

        <label for="Week">Week:</label>
        <input type="number" id="Week" name="Week" value="1" min="1" max="52" required>

        <label for="Day_of_Week">Day of Week (0-6):</label>
        <input type="number" id="Day_of_Week" name="Day_of_Week" value="4" min="0" max="6" required>

        <button type="submit">Get Forecast</button>
    </form>

    <div id="predictionResult"></div>

    <script>
        document.getElementById('forecastForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // Convert all values to numbers
            for (let key in data) {
                data[key] = parseFloat(data[key]);
            }

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const result = await response.json();
                    document.getElementById('predictionResult').innerText = `Forecasted Weekly Sales: $${result.prediction.toLocaleString()}`;
                } else {
                    const error = await response.json();
                    document.getElementById('predictionResult').innerText = `Error: ${error.error}`;
                }
            } catch (error) {
                document.getElementById('predictionResult').innerText = `Error: ${error}`;
            }
        });
    </script>
</body>
</html>